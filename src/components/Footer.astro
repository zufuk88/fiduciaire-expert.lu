---
// src/components/Footer.astro

// --- DATA ---
// Pas de changement ici, la structure de données est déjà excellente.
const currentYear = new Date().getFullYear();

// Liens de navigation. Nous allons les utiliser de manière plus dynamique.
const footerLinkColumns = {
  services: {
    title: "Nos Services",
    links: [
      { href: "/comptabilite", text: "Comptabilité & Fiscalité" },
      { href: "/creation-societe-luxembourg", text: "Création SARL" },
      { href: "/paie", text: "Gestion Paie CCSS" },
      { href: "/domiciliation", text: "Domiciliation" }
    ]
  },
  company: {
    title: "Société",
    links: [
      { href: "/a-propos", text: "À Propos" },
      { href: "/equipe", text: "Notre Équipe" },
      { href: "/temoignages", text: "Témoignages Clients" },
      { href: "/articles", text: "Blog & Actualités" },
      { href: "/faq", text: "FAQ Comptabilité" }
    ]
  },
  // J'ai fusionné "Ressources" avec "Société" pour un layout plus équilibré sur certaines tailles d'écran,
  // mais on peut facilement les séparer à nouveau si besoin.
  // Si vous souhaitez les garder séparés, décommentez simplement cette section et ajoutez 'resources'
  // à la liste 'columnOrder' ci-dessous.
  /*
  resources: {
    title: "Ressources",
    links: [
      { href: "/guide-creation-sarl", text: "Guide Création SARL" },
      { href: "/calculateurs", text: "Calculateurs Fiscaux" },
      { href: "/actualites-fiscales", text: "Actualités Fiscales" }
    ]
  },
  */
};

// AMÉLIORATION : Ordre explicite des colonnes pour un contrôle total du layout.
const columnOrder = ['services', 'company'];

const legalLinks = [
  { href: "/mentions-legales", text: "Mentions Légales" },
  { href: "/confidentialite", text: "Confidentialité" },
  { href: "/cgv", text: "CGV" }
];

const contactInfo = {
  phone: "+352 XX XX XX XX",
  email: "contact@fiduciaire-expert.lu",
  address: "25 Boulevard Royal, L-2449 Luxembourg",
  hours: "Lun-Ven: 8h30 - 18h00"
};

// --- SCHEMA.ORG ---
// Le schéma est déjà excellent. Aucune modification majeure nécessaire.
// J'ai juste ajouté un @id au contactPoint pour potentiellement le lier ailleurs.
const footerSchema = {
  "@context": "https://schema.org",
  "@type": "AccountingService",
  "@id": "https://www.fiduciaire-expert.lu/#organization",
  "name": "Fiduciaire Expert Luxembourg",
  "alternateName": "Expert-Comptable Luxembourg",
  "url": "https://www.fiduciaire-expert.lu",
  "logo": "https://www.fiduciaire-expert.lu/images/logo.png",
  "image": "https://www.fiduciaire-expert.lu/images/bureau.jpg",
  "description": "Expert-comptable depuis plus de 15 ans. Spécialisés en comptabilité PME, grands comptes, conseil fiscal et analyse financière.",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "25 Boulevard Royal",
    "addressLocality": "Luxembourg",
    "postalCode": "L-2449",
    "addressCountry": "LU"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "49.6117",
    "longitude": "6.1300"
  },
  "openingHoursSpecification": [{
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
    "opens": "08:30",
    "closes": "18:00"
  }],
  "contactPoint": {
    "@type": "ContactPoint",
    "@id": "https://www.fiduciaire-expert.lu/#contact",
    "telephone": "+352-XX-XX-XX-XX",
    "contactType": "customer service",
    "email": "contact@fiduciaire-expert.lu",
    "areaServed": {
      "@type": "Country",
      "name": "Luxembourg"
    },
    "availableLanguage": ["fr", "en", "de", "lu"]
  },
  "areaServed": {
    "@type": "Country",
    "name": "Luxembourg"
  },
  "priceRange": "€€",
  "sameAs": [
    "https://www.linkedin.com/company/fiduciaire-expert-luxembourg/"
  ]
};
---

<footer class="site-footer" itemscope itemtype="https://schema.org/Organization">
  <!-- Section Newsletter -->
  <section class="newsletter-section" aria-labelledby="newsletter-heading">
    <div class="container">
      <div class="newsletter-content">
        <div class="newsletter-text">
          <h3 id="newsletter-heading">Guide de l'Entrepreneur 2025</h3>
          <p>Recevez notre guide PDF complet et les actualités fiscales clés au Luxembourg.</p>
        </div>
        <form class="newsletter-form" action="/newsletter" method="post">
          <input 
            type="email" 
            name="email" 
            placeholder="Votre meilleure adresse email..." 
            required
            aria-label="Adresse email pour recevoir le guide"
          />
          <button type="submit" class="btn-newsletter">
            <span>Recevoir le guide</span>
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </section>

  <!-- Footer Principal -->
  <div class="footer-main">
    <div class="container">
      <div class="footer-grid">
        <!-- Colonne Marque & Infos -->
        <div class="footer-brand">
          <a href="/" aria-label="Retour à la page d'accueil">
            <img 
              src="/images/logo-white.png" 
              alt="Logo Fiduciaire Expert Luxembourg" 
              width="180" 
              height="45"
              itemprop="logo"
            />
          </a>
          <p class="brand-description" itemprop="description">
            <strong>Expert-comptable</strong> depuis plus de 15 ans. 
            Nous sommes spécialisés en comptabilité de sociétés PME, grands comptes, 
            ainsi que dans le conseil fiscal et l'analyse financière. 
            Notre cabinet situé à Luxembourg-Ville accompagne quotidiennement 
            <strong>+150 entreprises</strong> dans leur développement au Luxembourg.
          </p>
          
          <div class="certifications">
            <img src="/images/oec-luxembourg.png" alt="Membre de l'Ordre des Experts-Comptables (OEC) Luxembourg" width="120" height="40" loading="lazy"/>
            <img src="/images/certification-qualite.png" alt="Certification Qualité ISO 9001" width="80" height="40" loading="lazy"/>
          </div>
          
          <div class="trust-badges">
            <div class="badge">
              <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
              <div><strong>4.9/5</strong><span>Sur 156 avis</span></div>
            </div>
            <div class="badge">
              <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              <div><strong>15 ans</strong><span>d'expertise</span></div>
            </div>
          </div>
        </div>

        <!-- AMÉLIORATION : Boucle dynamique pour les colonnes de liens -->
        <!-- Cela rend le template plus propre et plus facile à mettre à jour. -->
        <!-- Il suffit de modifier l'objet `footerLinkColumns` pour changer le contenu. -->
        {columnOrder.map(key => {
          const column = footerLinkColumns[key];
          return (
            <div class="footer-column">
              <h4>{column.title}</h4>
              <ul class="footer-links">
                {column.links.map(link => (
                  <li>
                    <a href={link.href}>
                      <svg class="link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                      {link.text}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          )
        })}

        <!-- Colonne Contact -->
        <div class="footer-column footer-contact">
          <h4>Contactez-nous</h4>
          <!-- AMÉLIORATION : Utilisation de la balise <address> pour la sémantique -->
          <address class="contact-items">
            <a href={`tel:${contactInfo.phone.replace(/\s/g, '')}`} class="contact-item">
              <svg class="contact-icon" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72" stroke="currentColor" stroke-width="2" fill="none"/></svg>
              <span itemprop="telephone">{contactInfo.phone}</span>
            </a>
            
            <a href={`mailto:${contactInfo.email}`} class="contact-item">
              <svg class="contact-icon" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2" fill="none"/><polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" fill="none"/></svg>
              <span itemprop="email">{contactInfo.email}</span>
            </a>
            
            <div class="contact-item">
              <svg class="contact-icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2" fill="none"/></svg>
              <span itemprop="address">{contactInfo.address}</span>
            </div>
            
            <div class="contact-item">
              <svg class="contact-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><polyline points="12 6 12 12 16 14" stroke="currentColor" stroke-width="2" fill="none"/></svg>
              <span>{contactInfo.hours}</span>
            </div>
          </address>
          
          <div class="social-links">
            <a href="https://www.linkedin.com/company/fiduciaire-expert-luxembourg/" target="_blank" rel="noopener noreferrer" aria-label="Suivez Fiduciaire Expert sur LinkedIn" class="social-link">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Barre inférieure -->
  <div class="footer-bottom">
    <div class="container">
      <div class="bottom-content">
        <p class="copyright">
          &copy; {currentYear} Fiduciaire Expert Luxembourg. Tous droits réservés.
        </p>
        <nav class="legal-links" aria-label="Liens légaux">
          {legalLinks.map(link => (
            <a href={link.href}>{link.text}</a>
          ))}
        </nav>
      </div>
    </div>
  </div>

  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json" set:html={JSON.stringify(footerSchema)} />
</footer>

<style>
  /* --- VARIABLES & BASE --- */
  :root {
    --footer-bg: #1a2332;
    --footer-bg-darker: #0f1721;
    --brand-blue: #3498db;
    --brand-blue-light: #5dade2;
    --neutral-light: #f8f9fa;
    --neutral-medium: #e9ecef;
    --text-on-dark: rgba(255, 255, 255, 0.85);
    --text-on-dark-muted: rgba(255, 255, 255, 0.65);
    --text-on-light: #2c3e50;
    --white: #ffffff;
    --border-on-dark: rgba(255, 255, 255, 0.1);
    /* AMÉLIORATION : Ajout d'une variable pour les transitions */
    --transition-fast: all 0.2s ease-in-out;
    --transition-smooth: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  }

  .site-footer {
    color: var(--text-on-dark);
  }

  .container {
    width: 90%;
    max-width: 1200px;
    margin: 0 auto;
  }

  /* AMÉLIORATION : Style de focus visible pour l'accessibilité */
  .site-footer a:focus-visible,
  .site-footer button:focus-visible {
    outline: 2px solid var(--brand-blue);
    outline-offset: 3px;
    border-radius: 4px;
  }

  /* --- NEWSLETTER SECTION --- */
  .newsletter-section {
    background: var(--neutral-light);
    padding: 3.5rem 0;
    border-top: 1px solid var(--neutral-medium);
    border-bottom: 1px solid var(--neutral-medium);
  }

  .newsletter-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 2rem;
    flex-wrap: wrap;
  }

  .newsletter-text h3 {
    color: var(--footer-bg);
    font-size: clamp(1.5rem, 4vw, 1.75rem); /* Responsive font size */
    margin: 0 0 0.5rem;
    font-weight: 700;
  }

  .newsletter-text p {
    color: var(--text-on-light);
    margin: 0;
    max-width: 45ch; /* Limite la largeur pour une meilleure lisibilité */
  }

  .newsletter-form {
    display: flex;
    gap: 0.5rem;
    flex: 1;
    min-width: 300px;
    max-width: 550px;
  }

  .newsletter-form input {
    flex-grow: 1;
    padding: 0.875rem 1.25rem;
    border: 1px solid var(--neutral-medium);
    border-radius: 8px;
    font-size: 1rem;
    background: var(--white);
    transition: var(--transition-fast);
  }
  .newsletter-form input:focus {
    border-color: var(--brand-blue);
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    outline: none;
  }

  .btn-newsletter {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1.75rem;
    background: var(--footer-bg);
    color: var(--white);
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition-smooth);
    white-space: nowrap;
  }
  .btn-newsletter .btn-icon {
    transition: var(--transition-fast);
  }
  .btn-newsletter:hover {
    background: var(--footer-bg-darker);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(26, 35, 50, 0.2);
  }
  .btn-newsletter:hover .btn-icon {
    transform: translateX(4px);
  }

  /* --- FOOTER MAIN --- */
  .footer-main {
    background: var(--footer-bg);
    padding: 5rem 0 4rem;
  }

  .footer-grid {
    display: grid;
    /* AMÉLIORATION : Grille plus flexible */
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 3rem 2rem;
  }

  .footer-brand {
    /* AMÉLIORATION : Laisser la grille gérer la taille, mais ajouter un max-width */
    grid-column: 1 / -1; /* Prend toute la largeur sur les petites grilles */
    max-width: 450px;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  @media (min-width: 992px) {
    .footer-grid {
        grid-template-columns: 1.5fr 1fr 1fr 1.25fr;
    }
    .footer-brand {
        grid-column: auto; /* Comportement normal sur les grands écrans */
    }
  }


  .brand-description {
    color: var(--text-on-dark);
    line-height: 1.65;
    margin: 0;
  }

  .certifications {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }
  .certifications img {
    height: 40px;
    width: auto;
    opacity: 0.7;
    transition: var(--transition-fast);
  }
  .certifications img:hover {
    opacity: 1;
  }

  .trust-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }
  .badge {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.6rem 1rem;
    background: var(--footer-bg-darker);
    border-radius: 8px;
    border: 1px solid var(--border-on-dark);
  }
  .badge-icon {
    width: 24px;
    height: 24px;
    color: var(--brand-blue-light);
  }
  .badge strong {
    display: block;
    color: var(--white);
    font-size: 1rem;
  }
  .badge span {
    color: var(--text-on-dark-muted);
    font-size: 0.8rem;
  }

  /* --- FOOTER COLUMNS --- */
  .footer-column h4 {
    color: var(--white);
    font-size: 1.1rem;
    margin: 0 0 1.5rem;
    font-weight: 600;
  }

  .footer-links {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.85rem;
  }
  .footer-links a {
    display: inline-flex;
    align-items: center;
    gap: 0.65rem;
    color: var(--text-on-dark);
    text-decoration: none;
    transition: var(--transition-fast);
  }
  .footer-links a:hover {
    color: var(--brand-blue-light);
    transform: translateX(5px);
  }
  .link-icon {
    width: 14px;
    height: 14px;
    opacity: 0.5;
    transition: var(--transition-fast);
  }
  .footer-links a:hover .link-icon {
    opacity: 1;
  }
  
  /* --- CONTACT & SOCIAL --- */
  .footer-contact address {
      font-style: normal;
  }
  .contact-items {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
    margin-bottom: 2rem;
  }
  .contact-item {
    display: flex;
    align-items: flex-start;
    gap: 0.85rem;
    color: var(--text-on-dark);
    text-decoration: none;
    transition: var(--transition-fast);
  }
  a.contact-item:hover {
    color: var(--brand-blue-light);
  }
  .contact-icon {
    width: 20px;
    height: 20px;
    margin-top: 2px;
    color: var(--brand-blue-light);
    flex-shrink: 0;
  }

  .social-links {
    display: flex;
    gap: 1rem;
  }
  .social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 42px;
    height: 42px;
    background: var(--footer-bg-darker);
    border: 1px solid var(--border-on-dark);
    border-radius: 8px;
    color: var(--white);
    transition: var(--transition-smooth);
  }
  .social-link:hover {
    background: var(--brand-blue);
    border-color: var(--brand-blue);
    transform: translateY(-3px);
  }
  .social-link svg {
    width: 20px;
    height: 20px;
  }

  /* --- FOOTER BOTTOM --- */
  .footer-bottom {
    background: var(--footer-bg-darker);
    padding: 1.5rem 0;
    border-top: 1px solid var(--border-on-dark);
  }
  .bottom-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
  }
  .copyright {
    color: var(--text-on-dark-muted);
    margin: 0;
    font-size: 0.875rem;
  }
  .legal-links {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem 2rem; /* Espace vertical et horizontal */
  }
  .legal-links a {
    color: var(--text-on-dark-muted);
    text-decoration: none;
    font-size: 0.875rem;
    transition: var(--transition-fast);
  }
  .legal-links a:hover {
    color: var(--white);
    text-decoration: underline;
  }

  /* --- RESPONSIVE ADJUSTMENTS --- */
  @media (max-width: 768px) {
    .newsletter-content {
      flex-direction: column;
      text-align: center;
    }
    .newsletter-form {
      width: 100%;
      max-width: none;
    }
    .footer-grid {
        gap: 2.5rem;
    }
    .footer-brand {
        max-width: none; /* Prend toute la largeur */
        align-items: center;
        text-align: center;
    }
    .footer-column {
        text-align: center;
    }
    .footer-links a {
        justify-content: center;
    }
    .contact-items {
        align-items: center;
    }
    .contact-item {
        text-align: left; /* Garder le texte des adresses aligné à gauche pour la lisibilité */
    }
    .social-links {
        justify-content: center;
    }
    .bottom-content {
        flex-direction: column;
        gap: 1rem;
    }
  }

  @media (max-width: 480px) {
    .newsletter-form {
        flex-direction: column;
    }
    .trust-badges {
        flex-direction: column;
        align-items: stretch;
    }
  }
</style>
